<div class="grid gap-6 justify-center">
    {{/* Show message if we got one */}}

    <div id="msg-container" class="text-xl italic text-quinary"></div>

    {{/*  ACTION cannot have a space! Check when auto-formatting */}}
    <form action="{{- .Get "action" -}}" method="POST" class="flex flex-col gap-2 md:w-[512px]">
        <div class="grid sm:grid-cols-2 gap-2">
            <input type="text" name="name"
                class="bg-neutral-800 border-neutral-700 border drop-shadow-lg rounded-md p-3" placeholder="Your Name"
                required />
            <input type="email" name="email"
                class="bg-neutral-800 border-neutral-700 border drop-shadow-lg rounded-md p-3"
                placeholder="Email Address" required />
        </div>
        <input type="text" name="_subject"
            class="bg-neutral-800 border-neutral-700 border drop-shadow-lg rounded-md p-3" placeholder="Subject"
            required>

        <textarea placeholder="Message" class="bg-neutral-800 border-neutral-700 border drop-shadow-lg rounded-md p-3"
            name="message" rows="10" required></textarea>

        <button type="submit"
            class="flex justify-center items-center self-center gap-2 w-[200px] bg-primary drop-shadow-lg rounded-md p-3 font-semibold text-lg">
            Send
            <div><svg xmlns="http://www.w3.org/2000/svg" height="28px" viewBox="0 -960 960 960" width="28px"
                    fill="#e8eaed">
                    <path
                        d="M120-160v-640l760 320-760 320Zm80-120 474-200-474-200v140l240 60-240 60v140Zm0 0v-400 400Z" />
                </svg></div>
        </button>
        <input type="hidden" name="_captcha" value="false">
        <input id="nextURL" type="hidden" name="_next" value="{{ .Page.Permalink }}">
    </form>
</div>

<script>
    // Overwrite _next location to current URL, Hugo's Permalink uses the hostname of the server, 
    //   when that's localhost the redirect is broken.
    const nextURL = document.getElementById("nextURL");
    // nextURL.value = ;
    nextURL.value = `${window.location.href}?msg=Message%2520Sent%21%2C%2520thank%2520you%21`;


    // Get the msg from the params if there is one
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('msg')) {
        const msgContainer = document.getElementById('msg-container');
        msgContainer.textContent = decodeURI(urlParams.get("msg"));

    }
</script>